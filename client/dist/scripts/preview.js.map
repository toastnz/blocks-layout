{"version":3,"file":"preview.js","mappings":"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","sources":["webpack://blocks-layouts/./node_modules/domobserverjs/dist/index.js","webpack://blocks-layouts/./client/source/scripts/preview.js"],"sourcesContent":["var e={d:(t,s)=>{for(var r in s)e.o(s,r)&&!e.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:s[r]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)},t={};e.d(t,{A:()=>o});const s={childList:!0,subtree:!0},r=e=>console.log(\"DomObserver:\",e);class o{constructor(){this.agents=[],this.observers=new Map}findOrCreateObserver(e){let t=this.observers.get(e);return t||(t=new MutationObserver((()=>{this.agents.filter((t=>t.settings===e)).forEach((e=>e.update()))})),t.observe(document.body,e),this.observers.set(e,t),t)}observe(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:\"\",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:r,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:s;if(!e)return console.error(e+\" DomObserver not created: No selector provided\");if(!t||\"function\"!=typeof t)return console.error(e+\" DomObserver not created: No callback provided\");o=Object.assign(o,s),this.findOrCreateObserver(o);const c=new i(e,t,o);this.agents.push(c)}}class i{constructor(e,t,s){this.cache=new Set,this.timeouts={},this.selector=e,this.callback=t,this.settings=s,this.update()}update(){clearTimeout(this.timeouts.update),this.timeouts.update=setTimeout((()=>{const e=[...document.querySelectorAll(this.selector)].filter((e=>!this.cache.has(e)));e.length&&(e.forEach((e=>this.cache.add(e))),this.callback(e))}),100)}}var c=t.A;export{c as default};","// /*------------------------------------------------------------------\n// Import styles\n// ------------------------------------------------------------------*/\n\n// import 'styles/preview.scss';\n\n// /*------------------------------------------------------------------\n// Scripts\n// ------------------------------------------------------------------*/\n\nimport DomObserverController from 'domobserverjs';\n\n/*------------------------------------------------------------------\nSetup\n------------------------------------------------------------------*/\n\n// Create a new instance of the DomObserverController\nvar CMSObserver = new DomObserverController();\nfunction movePreviewToNewPanel(preview) {\n  // Find the root element\n  var root = document.querySelector('.cms-content .panel');\n\n  // Create a new fieldset element inside the root\n  var fieldset = document.createElement('fieldset');\n\n  // Make sure the preview and root exist\n  if (!preview || !root) return;\n  root.appendChild(fieldset);\n\n  // Move the preview to the root\n  fieldset.appendChild(preview);\n}\nfunction createThumb(preview) {\n  // Create a new button element to drag the preview width\n  var thumb = document.createElement('button');\n\n  // We will toggle this to toggle the dragging state\n  var isDragging = false;\n\n  // Add a class\n  thumb.classList.add('preview-thumb');\n\n  // Add the thumb to the preview\n  preview.appendChild(thumb);\n\n  // Add a mouse down event listener\n  thumb.addEventListener('mousedown', function () {\n    // Set dragging to true\n    isDragging = true;\n    preview.classList.add('dragging');\n  });\n  window.addEventListener('mouseup', function () {\n    // Set dragging to false\n    isDragging = false;\n    preview.classList.remove('dragging');\n  });\n  window.addEventListener('mousemove', function (e) {\n    // If we are not dragging, return\n    if (!isDragging) return;\n\n    // Get the parent panel and its container\n    var panel = preview.parentElement;\n    var container = panel.parentElement;\n\n    // Calculate the mouse X position relative to the container\n    var mouseX = e.clientX - 10 - container.getBoundingClientRect().left;\n\n    // Calculate the container width\n    var containerWidth = container.clientWidth;\n\n    // Get the mouseX as a percentage of the container width\n    var percentage = mouseX / containerWidth * 100;\n\n    // Clamp the percentage to between 25% and 75% and round to 2 decimal places\n    var clampedPercentage = 100 - Math.min(Math.max(percentage, 25), 75).toFixed(2);\n\n    // Set the width of the preview\n    document.body.style.setProperty('--block-preview-width', \"\".concat(clampedPercentage, \"%\"));\n  });\n}\n\n// Observe the CMS for the toast-block-layouts fieldsets\nCMSObserver.observe('#BlockPreviewFrame', function (items) {\n  // Grab the preview\n  var preview = items[0];\n  // Move the preview to the root\n  movePreviewToNewPanel(preview);\n  // Create the thumb\n  createThumb(preview);\n});\n\n// Chuck this on the normal page preivew cus why not ;)\nCMSObserver.observe('.cms-preview .panel', function (items) {\n  // Grab the preview\n  var preview = items[0];\n  // Create the thumb\n  createThumb(preview);\n});"],"names":["e","d","t","s","r","o","Object","defineProperty","enumerable","get","prototype","hasOwnProperty","call","A","childList","subtree","console","log","constructor","this","agents","observers","Map","findOrCreateObserver","let","MutationObserver","filter","settings","forEach","update","observe","document","body","set","arguments","length","error","assign","c","i","push","cache","Set","timeouts","selector","callback","clearTimeout","setTimeout","querySelectorAll","has","add","CMSObserver","createThumb","preview","thumb","createElement","isDragging","classList","appendChild","addEventListener","window","remove","containerWidth","container","parentElement","mouseX","clientX","getBoundingClientRect","left","clientWidth","clampedPercentage","Math","min","max","toFixed","style","setProperty","concat","items","root","fieldset","querySelector"],"sourceRoot":""}