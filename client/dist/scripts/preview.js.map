{"version":3,"file":"preview.js","mappings":"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","sources":["webpack://blocks-layouts/./node_modules/domobserverjs/dist/index.js","webpack://blocks-layouts/./client/source/styles/preview.scss?1000","webpack://blocks-layouts/webpack/bootstrap","webpack://blocks-layouts/webpack/runtime/define property getters","webpack://blocks-layouts/webpack/runtime/hasOwnProperty shorthand","webpack://blocks-layouts/webpack/runtime/make namespace object","webpack://blocks-layouts/./client/source/scripts/preview.js"],"sourcesContent":["var e={d:(t,s)=>{for(var r in s)e.o(s,r)&&!e.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:s[r]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)},t={};e.d(t,{A:()=>o});const s={childList:!0,subtree:!0},r=e=>console.log(\"DomObserver:\",e);class o{constructor(){this.agents=[],this.observers=new Map}findOrCreateObserver(e){let t=this.observers.get(e);return t||(t=new MutationObserver((()=>{this.agents.filter((t=>t.settings===e)).forEach((e=>e.update()))})),t.observe(document.body,e),this.observers.set(e,t),t)}observe(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:\"\",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:r,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:s;if(!e)return console.error(e+\" DomObserver not created: No selector provided\");if(!t||\"function\"!=typeof t)return console.error(e+\" DomObserver not created: No callback provided\");o=Object.assign(o,s),this.findOrCreateObserver(o);const c=new i(e,t,o);this.agents.push(c)}}class i{constructor(e,t,s){this.cache=new Set,this.timeouts={},this.selector=e,this.callback=t,this.settings=s,this.update()}update(){clearTimeout(this.timeouts.update),this.timeouts.update=setTimeout((()=>{const e=[...document.querySelectorAll(this.selector)].filter((e=>!this.cache.has(e)));e.length&&(e.forEach((e=>this.cache.add(e))),this.callback(e))}),100)}}var c=t.A;export{c as default};","// extracted by mini-css-extract-plugin\nexport {};","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","/*------------------------------------------------------------------\nImport styles\n------------------------------------------------------------------*/\n\nimport 'styles/preview.scss';\n\n/*------------------------------------------------------------------\nScripts\n------------------------------------------------------------------*/\n\nimport DomObserverController from 'domobserverjs';\n\n/*------------------------------------------------------------------\nSetup\n------------------------------------------------------------------*/\n\n// Create a new instance of the DomObserverController\nconst CMSObserver = new DomObserverController();\n\nfunction movePreviewToNewPanel(preview) {\n  // Find the root element\n  const root = document.querySelector('.cms-content .panel');\n\n  // Create a new fieldset element inside the root\n  const fieldset = document.createElement('fieldset');\n\n  // Make sure the preview and root exist\n  if(!preview || !root) return;\n\n  root.appendChild(fieldset);\n\n  // Move the preview to the root\n  fieldset.appendChild(preview);\n}\n\nfunction createThumb(preview) {\n  // Create a new button element to drag the preview width\n  const thumb = document.createElement('button');\n\n  // We will toggle this to toggle the dragging state\n  let isDragging = false;\n\n  // Add a class\n  thumb.classList.add('preview-thumb');\n\n  // Add the thumb to the preview\n  preview.appendChild(thumb);\n\n  // Add a mouse down event listener\n  thumb.addEventListener('mousedown', () => {\n    // Set dragging to true\n    isDragging = true;\n    preview.classList.add('dragging');\n  });\n\n  window.addEventListener('mouseup', () => {\n    // Set dragging to false\n    isDragging = false;\n    preview.classList.remove('dragging');\n  });\n\n  window.addEventListener('mousemove', (e) => {\n    // If we are not dragging, return\n    if (!isDragging) return;\n\n    // Get the parent panel and its container\n    const panel = preview.parentElement;\n    const container = panel.parentElement;\n\n    // Calculate the mouse X position relative to the container\n    const mouseX = (e.clientX - 10) - container.getBoundingClientRect().left;\n\n    // Calculate the container width\n    const containerWidth = container.clientWidth;\n\n    // Get the mouseX as a percentage of the container width\n    const percentage = (mouseX / containerWidth) * 100;\n\n    // Clamp the percentage to between 25% and 75% and round to 2 decimal places\n    const clampedPercentage = 100 - Math.min(Math.max(percentage, 25), 75).toFixed(2);\n\n    // Set the width of the preview\n    document.body.style.setProperty('--block-preview-width', `${clampedPercentage}%`);\n  });\n}\n\n// Observe the CMS for the toast-block-layouts fieldsets\nCMSObserver.observe('#BlockPreviewFrame', (items) => {\n  // Grab the preview\n  const preview = items[0];\n  // Move the preview to the root\n  movePreviewToNewPanel(preview);\n  // Create the thumb\n  createThumb(preview);\n});\n\n// Chuck this on the normal page preivew cus why not ;)\nCMSObserver.observe('[name=\"cms-preview-iframe\"]', (items) => {\n  console.log(items);\n  // Grab the preview\n  const preview = items[0];\n  // Create the thumb\n  createThumb(preview);\n});\n"],"names":["DomObserverController","CMSObserver","movePreviewToNewPanel","preview","root","document","querySelector","fieldset","createElement","appendChild","createThumb","thumb","isDragging","classList","add","addEventListener","window","remove","e","panel","parentElement","container","mouseX","clientX","getBoundingClientRect","left","containerWidth","clientWidth","percentage","clampedPercentage","Math","min","max","toFixed","body","style","setProperty","concat","observe","items","console","log"],"sourceRoot":""}